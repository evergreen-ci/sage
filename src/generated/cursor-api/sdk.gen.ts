// This file is auto-generated by @hey-api/openapi-ts

import type { Client, Options as Options2, TDataShape } from './client';
import { client } from './client.gen';
import type { AddFollowupData, AddFollowupErrors, AddFollowupResponses, CreateAgentData, CreateAgentErrors, CreateAgentResponses, DeleteAgentData, DeleteAgentErrors, DeleteAgentResponses, GetAgentConversationData, GetAgentConversationErrors, GetAgentConversationResponses, GetAgentData, GetAgentErrors, GetAgentResponses, GetMeData, GetMeErrors, GetMeResponses, ListAgentsData, ListAgentsErrors, ListAgentsResponses, ListModelsData, ListModelsErrors, ListModelsResponses, ListRepositoriesData, ListRepositoriesErrors, ListRepositoriesResponses, StopAgentData, StopAgentErrors, StopAgentResponses } from './types.gen';

export type Options<TData extends TDataShape = TDataShape, ThrowOnError extends boolean = boolean> = Options2<TData, ThrowOnError> & {
    /**
     * You can provide a client instance returned by `createClient()` instead of
     * individual options. This might be also useful if you want to implement a
     * custom client.
     */
    client?: Client;
    /**
     * You can pass arbitrary values through the `meta` object. This can be
     * used to access values that aren't defined as part of the SDK function.
     */
    meta?: Record<string, unknown>;
};

class HeyApiClient {
    protected client: Client;
    
    constructor(args?: {
        client?: Client;
    }) {
        this.client = args?.client ?? client;
    }
}

class HeyApiRegistry<T> {
    private readonly defaultKey = 'default';
    
    private readonly instances: Map<string, T> = new Map();
    
    get(key?: string): T {
        const instance = this.instances.get(key ?? this.defaultKey);
        if (!instance) {
            throw new Error(`No SDK client found. Create one with "new Sdk()" to fix this error.`);
        }
        return instance;
    }
    
    set(value: T, key?: string): void {
        this.instances.set(key ?? this.defaultKey, value);
    }
}

export class Sdk extends HeyApiClient {
    public static readonly __registry = new HeyApiRegistry<Sdk>();
    
    constructor(args?: {
        client?: Client;
        key?: string;
    }) {
        super(args);
        Sdk.__registry.set(this, args?.key);
    }
    
    /**
     * List agents
     *
     * List all cloud agents for the authenticated user
     */
    public listAgents<ThrowOnError extends boolean = false>(options?: Options<ListAgentsData, ThrowOnError>) {
        return (options?.client ?? this.client).get<ListAgentsResponses, ListAgentsErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents',
            ...options
        });
    }
    
    /**
     * Launch an agent
     *
     * Start a new cloud agent to work on your repository
     */
    public createAgent<ThrowOnError extends boolean = false>(options: Options<CreateAgentData, ThrowOnError>) {
        return (options.client ?? this.client).post<CreateAgentResponses, CreateAgentErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options.headers
            }
        });
    }
    
    /**
     * Delete an agent
     *
     * Delete a cloud agent. This action is permanent and cannot be undone.
     */
    public deleteAgent<ThrowOnError extends boolean = false>(options: Options<DeleteAgentData, ThrowOnError>) {
        return (options.client ?? this.client).delete<DeleteAgentResponses, DeleteAgentErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents/{id}',
            ...options
        });
    }
    
    /**
     * Agent status
     *
     * Retrieve the current status and results of a cloud agent
     */
    public getAgent<ThrowOnError extends boolean = false>(options: Options<GetAgentData, ThrowOnError>) {
        return (options.client ?? this.client).get<GetAgentResponses, GetAgentErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents/{id}',
            ...options
        });
    }
    
    /**
     * Add followup
     *
     * Add a followup instruction to an existing cloud agent
     */
    public addFollowup<ThrowOnError extends boolean = false>(options: Options<AddFollowupData, ThrowOnError>) {
        return (options.client ?? this.client).post<AddFollowupResponses, AddFollowupErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents/{id}/followup',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options.headers
            }
        });
    }
    
    /**
     * Stop an agent
     *
     * Stop a running cloud agent. This pauses the agent's execution without deleting it. Stopped agents cannot be resumed.
     */
    public stopAgent<ThrowOnError extends boolean = false>(options: Options<StopAgentData, ThrowOnError>) {
        return (options.client ?? this.client).post<StopAgentResponses, StopAgentErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents/{id}/stop',
            ...options
        });
    }
    
    /**
     * Get agent conversation
     *
     * Retrieve the conversation history of a cloud agent, including all user prompts and assistant responses
     */
    public getAgentConversation<ThrowOnError extends boolean = false>(options: Options<GetAgentConversationData, ThrowOnError>) {
        return (options.client ?? this.client).get<GetAgentConversationResponses, GetAgentConversationErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/agents/{id}/conversation',
            ...options
        });
    }
    
    /**
     * API key info
     *
     * Retrieve information about the API key being used for authentication
     */
    public getMe<ThrowOnError extends boolean = false>(options?: Options<GetMeData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetMeResponses, GetMeErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/me',
            ...options
        });
    }
    
    /**
     * List available models
     *
     * Retrieve a list of recommended models for cloud agents
     */
    public listModels<ThrowOnError extends boolean = false>(options?: Options<ListModelsData, ThrowOnError>) {
        return (options?.client ?? this.client).get<ListModelsResponses, ListModelsErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/models',
            ...options
        });
    }
    
    /**
     * List GitHub repositories
     *
     * Retrieve a list of GitHub repositories accessible to the authenticated user
     */
    public listRepositories<ThrowOnError extends boolean = false>(options?: Options<ListRepositoriesData, ThrowOnError>) {
        return (options?.client ?? this.client).get<ListRepositoriesResponses, ListRepositoriesErrors, ThrowOnError>({
            security: [{ scheme: 'bearer', type: 'http' }],
            url: '/v0/repositories',
            ...options
        });
    }
}
